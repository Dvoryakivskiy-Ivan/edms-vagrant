@{
    ViewData["Title"] = "EDMS Home";
}

<h1 class="mb-4">EDMS Documentation System</h1>

<ul>
    <li>Registration, login and user profile are implemented on IdentityServer</li>
    <li>Access to EDMS functions is available only after authorization</li>
    <li>Role-based access control (Admin / User)</li>
</ul>

<hr />

@if (!User.Identity?.IsAuthenticated ?? true)
{
    <div class="alert alert-info">
        To access EDMS functions, you must log in or register.
    </div>

    <a class="btn btn-primary me-2"
       asp-controller="Account"
       asp-action="Login"
       asp-route-returnUrl="/">
        Login
    </a>

    <a class="btn btn-success"
       asp-controller="Account"
       asp-action="Register"
       asp-route-returnUrl="/">
        Register
    </a>
}
else
{
    <div class="alert alert-success">
        You logged in as <strong>@User.Identity!.Name</strong>
        (@(User.IsInRole("Admin") ? "Admin" : "User"))
    </div>

    <h3 class="mt-4">EDMS Functions</h3>
    <p>Choose one of the functions:</p>

    <div class="list-group mb-4">

        <a class="list-group-item list-group-item-action"
           asp-controller="Documents"
           asp-action="Browse">
            <strong>1) Viewing and searching documents</strong><br />
            <small>Available for users and administrators</small>
        </a>

        @if (User.IsInRole("Admin"))
        {
            <a class="list-group-item list-group-item-action"
               asp-controller="Documents"
               asp-action="Create">
                <strong>2) Document Creation</strong><br />
                <small>Only available to administrator</small>
            </a>

            <a class="list-group-item list-group-item-action"
               asp-controller="Documents"
               asp-action="Browse">
                <strong>3) Approval/change of document status</strong><br />
                <small>Only available to administrator</small>
            </a>
        }
        else
        {
            <div class="list-group-item text-muted">
                <strong>2) Document Creation</strong><br />
                <small>Only available to administrator</small>
            </div>

            <div class="list-group-item text-muted">
                <strong>3) Approval/change of document status</strong><br />
                <small>Only available to administrator</small>
            </div>
        }
    </div>

    // Profile 
    <a class="btn btn-outline-secondary me-2"
       asp-controller="Account"
       asp-action="Profile">
        Profile
    </a>

    <a class="btn btn-danger"
       href="https://localhost:7007/Account/Logout?backUrl=https%3A%2F%2Flocalhost%3A7219%2F&postLogoutUrl=https%3A%2F%2Flocalhost%3A7219%2FAccount%2FLocalLogout">
        Logout
    </a>

}
